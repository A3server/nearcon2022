{"version":3,"sources":["App.js","Weapons.js","index.js"],"names":["PixelPrice","BN","NearConfig","window","location","hostname","networkId","nodeUrl","contractName","walletUrl","Avocado","role","aria-label","className","Banana","Cucumber","Pepper","Berry","intToColor","c","toString","padStart","intToColorWithAlpha","a","Math","round","rgbaToInt","cr","cg","cb","ca","bgColor","bb","bg","br","imgColorToInt","int2hsv","cInt","substr","r","parseInt","g","b","v","max","min","h","transparentColor","generateGamma","hue","gammaColors","i","push","decodeLine","line","buf","Buffer","from","length","Error","pixels","color","readUInt32LE","ownerIndex","App","props","colors","map","toLowerCase","currentColor","substring","timeMs","Date","getTime","freeDrawingStartMsEstimated","OneDayMs","state","connected","signedIn","accountId","pendingPixels","boardLoaded","selectedCell","alpha","pickerColor","pickingColor","owners","accounts","highlightedAccountIndex","selectedOwnerIndex","farmingBanana","weaponsOn","weaponsCodePosition","freeDrawingStart","freeDrawingEnd","watchMode","_buttonDown","_oldCounts","_numFailedTxs","_balanceRefreshTimer","canvasRef","React","createRef","_context","_lines","_queue","_pendingPixels","_refreshBoardTimer","_sendQueueTimer","_stopRefreshTime","_accounts","_initNear","then","setState","_accountId","ircAccountId","replace","_freeDrawingStart","_freeDrawingEnd","hash","indexOf","setTimeout","enableWatchMode","canvas","this","current","getContext","click","rendering","drawImg","pickColor","saveColor","drawPixel","mouseMove","e","x","y","touches","rect","target","getBoundingClientRect","targetTouches","clientX","left","clientY","top","offsetX","offsetY","trunc","clientWidth","clientHeight","cell","JSON","stringify","renderCanvas","preventDefault","addEventListener","mouseDown","unselectCell","mouseUp","buttons","document","altKey","enablePickColor","key","disablePickColor","alert","logOut","requestSignIn","slice","_contract","draw","refreshAllowance","console","log","concat","Promise","all","refreshBoard","refreshAccountStats","forEach","p","_pending","ready","clearTimeout","_sendQueue","_pingQueue","balance","account","avocadoBalance","_isFreeDrawing","avocadoNeeded","img","imageData","w","width","height","d","Uint32Array","data","buffer","j","imgColor","account_id","accountIndex","account_index","parseFloat","avocado_balance","_pixelCost","bananaBalance","banana_balance","numPixels","num_pixels","farmingPreference","farming_preference","startTime","avocadoPixels","bananaPixels","avocadoRewardPerMs","bananaRewardPerMs","get_account","parseAccount","get_account_by_index","getAccount","clearInterval","setInterval","t","Object","assign","keyStore","nearAPI","BrowserLocalStorageKeyStore","deps","near","_keyStore","_near","_walletConnection","getAccountId","_account","viewMethods","changeMethods","get_pixel_cost","get_free_drawing_timestamp","freeDrawingTimestamp","_lineVersions","Array","fill","forced","hidden","get_line_versions","lineVersions","needLines","requestLines","lines","get_lines","results","flat","lineIndex","_refreshOwners","counts","sortedKeys","keys","sort","getAccountByIndex","ctx","fillStyle","fillRect","CellWidth","CellHeight","beginPath","strokeStyle","lineWidth","stroke","closePath","arc","PI","signOut","rgb","changeColor","hsl","newColor","index","splice","hex","hsv","amount","requiredBalance","muln","buy_tokens","select_farming_preference","berry","date","body","style","transition","backgroundColor","watchClass","isFreeDrawing","freeDrawing","initialTime","direction","timeToUpdate","lastUnit","checkpoints","time","Fragment","Days","formatValue","Hours","Minutes","Seconds","Milliseconds","content","onClick","Balance","detailed","onChange","switchBerry","checked","offColor","onColor","uncheckedIcon","checkedIcon","buyTokens","hueColorChange","alphaColorChange","triangle","onChangeComplete","marginBottom","aria-hidden","weapons","renderIt","renderImg","href","ref","Leaderboard","setHover","title","frameBorder","src","data-ribbon","Component","fraction","avacadoBalance","avocadoFarm","bananaFarm","toFixed","owner","Owner","isSelected","isHighlighted","onMouseEnter","onMouseLeave","Account","shortAccountId","Weapons","lockedAspect","sourceImage","Image","onload","clearRect","imageSmoothingQuality","drawImage","getImageData","reduce","sum","f","reader","FileReader","readAsDataURL","naturalWidth","naturalHeight","aspect","event","result","value","type","onFilesChange","onError","onFilesError","multiple","accepts","minFileSize","clickable","updateVal","changeLockedAspect","disabled","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.95095cc1.chunk.js","sourcesContent":["import \"./App.scss\";\nimport \"./gh-fork-ribbon.css\";\nimport React from \"react\";\nimport BN from \"bn.js\";\nimport * as nearAPI from \"near-api-js\";\nimport { AlphaPicker, HuePicker, GithubPicker } from \"react-color\";\nimport Switch from \"react-switch\";\nimport { Weapons } from \"./Weapons\";\nimport Timer from \"react-compound-timer\";\n\nconst PixelPrice = new BN(\"10000000000000000000000\");\nconst IsMainnet = window.location.hostname === \"berryclub.io\";\nconst TestNearConfig = {\n  networkId: \"testnet\",\n  nodeUrl: \"https://rpc.testnet.near.org\",\n  contractName: \"berryclub.testnet\",\n  walletUrl: \"https://wallet.testnet.near.org\",\n};\nconst MainNearConfig = {\n  networkId: \"mainnet\",\n  nodeUrl: \"https://rpc.mainnet.near.org\",\n  contractName: \"berryclub.ek.near\",\n  walletUrl: \"https://wallet.near.org\",\n};\nconst NearConfig = IsMainnet ? MainNearConfig : TestNearConfig;\n\nconst Avocado = (\n  <span role=\"img\" aria-label=\"avocado\" className=\"berry\">\n    🥑\n  </span>\n);\nconst Banana = (\n  <span role=\"img\" aria-label=\"banana\" className=\"berry\">\n    🍌\n  </span>\n);\nconst Cucumber = (\n  <span role=\"img\" aria-label=\"cucumber\" className=\"berry\">\n    🥒\n  </span>\n);\nconst Pepper = (\n  <span role=\"img\" aria-label=\"pepper\" className=\"berry\">\n    🌶️\n  </span>\n);\n\nconst Berry = {\n  Avocado: \"Avocado\",\n  Banana: \"Banana\",\n};\n\nconst BoardHeight = 50;\nconst BoardWidth = 50;\nconst NumLinesPerFetch = 50;\nconst ExpectedLineLength = 4 + 8 * BoardWidth;\nconst CellWidth = 12;\nconst CellHeight = 12;\nconst MaxNumColors = 31;\nconst BatchOfPixels = 100;\n// 500 ms\nconst BatchTimeout = 500;\nconst RefreshBoardTimeout = 1000;\nconst MaxWorkTime = 10 * 60 * 1000;\nconst OneDayMs = 24 * 60 * 60 * 1000;\n\nconst intToColor = (c) => `#${c.toString(16).padStart(6, \"0\")}`;\nconst intToColorWithAlpha = (c, a) =>\n  `#${c.toString(16).padStart(6, \"0\")}${Math.round(255 * a)\n    .toString(16)\n    .padStart(2, \"0\")}`;\n\nconst rgbaToInt = (cr, cg, cb, ca, bgColor) => {\n  const bb = bgColor & 255;\n  const bg = (bgColor >> 8) & 255;\n  const br = (bgColor >> 16) & 255;\n\n  const r = Math.round(cr * ca + br * (1 - ca));\n  const g = Math.round(cg * ca + bg * (1 - ca));\n  const b = Math.round(cb * ca + bb * (1 - ca));\n  return (r << 16) + (g << 8) + b;\n};\n\nconst imgColorToInt = (c, bgColor) => {\n  const cr = c & 255;\n  const cg = (c >> 8) & 255;\n  const cb = (c >> 16) & 255;\n  const ca = ((c >> 24) & 255) / 255;\n  return rgbaToInt(cr, cg, cb, ca, bgColor);\n};\n\nconst int2hsv = (cInt) => {\n  cInt = intToColor(cInt).substr(1);\n  const r = parseInt(cInt.substr(0, 2), 16) / 255;\n  const g = parseInt(cInt.substr(2, 2), 16) / 255;\n  const b = parseInt(cInt.substr(4, 2), 16) / 255;\n  let v = Math.max(r, g, b),\n    c = v - Math.min(r, g, b);\n  let h =\n    c && (v === r ? (g - b) / c : v === g ? 2 + (b - r) / c : 4 + (r - g) / c);\n  return [60 * (h < 0 ? h + 6 : h), v && c / v, v];\n};\nconst transparentColor = (c, a) =>\n  `rgba(${c >> 16}, ${(c >> 8) & 0xff}, ${c & 0xff}, ${a})`;\nconst generateGamma = (hue) => {\n  const gammaColors = [];\n  for (let i = 0; i < MaxNumColors; ++i) {\n    gammaColors.push(`hsl(${hue}, 100%, ${(100 * i) / (MaxNumColors - 1)}%)`);\n  }\n  return gammaColors;\n};\nconst decodeLine = (line) => {\n  let buf = Buffer.from(line, \"base64\");\n  if (buf.length !== ExpectedLineLength) {\n    throw new Error(\"Unexpected encoded line length\");\n  }\n  let pixels = [];\n  for (let i = 4; i < buf.length; i += 8) {\n    let color = buf.readUInt32LE(i);\n    let ownerIndex = buf.readUInt32LE(i + 4);\n    pixels.push({\n      color,\n      ownerIndex,\n    });\n  }\n  return pixels;\n};\n\nconst WeaponsCheat = \"idkfa\";\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const colors = [\n      \"#000000\",\n      \"#666666\",\n      \"#aaaaaa\",\n      \"#FFFFFF\",\n      \"#F44E3B\",\n      \"#D33115\",\n      \"#9F0500\",\n      \"#FE9200\",\n      \"#E27300\",\n      \"#C45100\",\n      \"#FCDC00\",\n      \"#FCC400\",\n      \"#FB9E00\",\n      \"#DBDF00\",\n      \"#B0BC00\",\n      \"#808900\",\n      \"#A4DD00\",\n      \"#68BC00\",\n      \"#194D33\",\n      \"#68CCCA\",\n      \"#16A5A5\",\n      \"#0C797D\",\n      \"#73D8FF\",\n      \"#009CE0\",\n      \"#0062B1\",\n      \"#AEA1FF\",\n      \"#7B64FF\",\n      \"#653294\",\n      \"#FDA1FF\",\n      \"#FA28FF\",\n      \"#AB149E\",\n    ].map((c) => c.toLowerCase());\n    // const currentColor = parseInt(colors[Math.floor(Math.random() * colors.length)].substring(1), 16);\n    const currentColor = parseInt(colors[0].substring(1), 16);\n    const defaultAlpha = 0.25;\n\n    const timeMs = new Date().getTime();\n    const freeDrawingStartMsEstimated =\n      timeMs -\n      ((timeMs - new Date(\"2021-05-09\")) % (7 * OneDayMs)) +\n      OneDayMs * 6;\n\n    this.state = {\n      connected: false,\n      signedIn: false,\n      accountId: null,\n      pendingPixels: 0,\n      boardLoaded: false,\n      selectedCell: null,\n      alpha: defaultAlpha,\n      currentColor,\n      pickerColor: intToColorWithAlpha(currentColor, defaultAlpha),\n      colors,\n      gammaColors: generateGamma(0),\n      pickingColor: false,\n      owners: [],\n      accounts: {},\n      highlightedAccountIndex: -1,\n      selectedOwnerIndex: false,\n      farmingBanana: false,\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n      freeDrawingStart: new Date(freeDrawingStartMsEstimated),\n      freeDrawingEnd: new Date(freeDrawingStartMsEstimated + OneDayMs),\n      watchMode: false,\n    };\n\n    this._buttonDown = false;\n    this._oldCounts = {};\n    this._numFailedTxs = 0;\n    this._balanceRefreshTimer = null;\n    this.canvasRef = React.createRef();\n    this._context = false;\n    this._lines = false;\n    this._queue = [];\n    this._pendingPixels = [];\n    this._refreshBoardTimer = null;\n    this._sendQueueTimer = null;\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    this._accounts = {};\n\n    this._initNear().then(() => {\n      this.setState(\n        {\n          connected: true,\n          signedIn: !!this._accountId,\n          accountId: this._accountId,\n          ircAccountId: this._accountId.replace(\".\", \"_\"),\n          freeDrawingStart: this._freeDrawingStart,\n          freeDrawingEnd: this._freeDrawingEnd,\n        },\n        () => {\n          if (window.location.hash.indexOf(\"watch\") >= 0) {\n            setTimeout(() => this.enableWatchMode(), 500);\n          }\n        }\n      );\n    });\n  }\n\n  componentDidMount() {\n    const canvas = this.canvasRef.current;\n    this._context = canvas.getContext(\"2d\");\n\n    const click = async () => {\n      if (this.state.watchMode) {\n        return;\n      }\n      if (this.state.rendering) {\n        await this.drawImg(this.state.selectedCell);\n      } else if (this.state.pickingColor) {\n        this.pickColor(this.state.selectedCell);\n      } else {\n        this.saveColor();\n        await this.drawPixel(this.state.selectedCell);\n      }\n    };\n\n    const mouseMove = (e) => {\n      let x, y;\n      if (\"touches\" in e) {\n        if (e.touches.length > 1) {\n          return true;\n        } else {\n          const rect = e.target.getBoundingClientRect();\n          x = e.targetTouches[0].clientX - rect.left;\n          y = e.targetTouches[0].clientY - rect.top;\n        }\n      } else {\n        x = e.offsetX;\n        y = e.offsetY;\n      }\n      x = Math.trunc((x / e.target.clientWidth) * BoardWidth);\n      y = Math.trunc((y / e.target.clientHeight) * BoardWidth);\n      let cell = null;\n      if (x >= 0 && x < BoardWidth && y >= 0 && y < BoardHeight) {\n        cell = { x, y };\n      }\n      if (JSON.stringify(cell) !== JSON.stringify(this.state.selectedCell)) {\n        this.setState(\n          {\n            selectedCell: cell,\n            selectedOwnerIndex:\n              this._lines &&\n              cell &&\n              this._lines[cell.y] &&\n              this._lines[cell.y][cell.x].ownerIndex,\n          },\n          async () => {\n            this.renderCanvas();\n            if (this.state.selectedCell !== null && this._buttonDown) {\n              await click();\n            }\n          }\n        );\n      }\n      e.preventDefault();\n      return false;\n    };\n\n    canvas.addEventListener(\"mousemove\", mouseMove);\n    canvas.addEventListener(\"touchmove\", mouseMove);\n\n    const mouseDown = async (e) => {\n      this._buttonDown = true;\n      if (this.state.selectedCell !== null) {\n        await click();\n      }\n    };\n\n    canvas.addEventListener(\"mousedown\", mouseDown);\n    canvas.addEventListener(\"touchstart\", mouseDown);\n\n    const unselectCell = () => {\n      this.setState(\n        {\n          selectedCell: null,\n        },\n        () => this.renderCanvas()\n      );\n    };\n\n    const mouseUp = async (e) => {\n      this._buttonDown = false;\n      if (\"touches\" in e) {\n        unselectCell();\n      }\n    };\n\n    canvas.addEventListener(\"mouseup\", mouseUp);\n    canvas.addEventListener(\"touchend\", mouseUp);\n\n    canvas.addEventListener(\"mouseleave\", unselectCell);\n\n    canvas.addEventListener(\"mouseenter\", (e) => {\n      if (this._buttonDown) {\n        if (!(\"touches\" in e) && !(e.buttons & 1)) {\n          this._buttonDown = false;\n        }\n      }\n    });\n\n    document.addEventListener(\"keydown\", (e) => {\n      e.altKey && this.enablePickColor();\n    });\n\n    document.addEventListener(\"keyup\", (e) => {\n      if (this.state.weaponsCodePosition < WeaponsCheat.length) {\n        if (\n          e.key.toLowerCase() === WeaponsCheat[this.state.weaponsCodePosition]\n        ) {\n          this.setState({\n            weaponsCodePosition: this.state.weaponsCodePosition + 1,\n            weaponsOn:\n              this.state.weaponsCodePosition + 1 === WeaponsCheat.length,\n          });\n        } else {\n          this.setState({\n            weaponsCodePosition: 0,\n          });\n        }\n      }\n      !e.altKey && this.disablePickColor();\n    });\n  }\n\n  enablePickColor() {\n    this.setState(\n      {\n        pickingColor: true,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  disablePickColor() {\n    this.setState(\n      {\n        pickingColor: false,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  pickColor(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const color = this._lines[cell.y][cell.x].color;\n\n    this.setState(\n      {\n        currentColor: color,\n        alpha: 1,\n        pickerColor: intToColorWithAlpha(color, 1),\n        gammaColors: generateGamma(int2hsv(color)[0]),\n        pickingColor: false,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  async refreshAllowance() {\n    alert(\n      \"You're out of access key allowance. Need sign in again to refresh it\"\n    );\n    await this.logOut();\n    await this.requestSignIn();\n  }\n\n  async _sendQueue() {\n    const pixels = this._queue.slice(0, BatchOfPixels);\n    this._queue = this._queue.slice(BatchOfPixels);\n    this._pendingPixels = pixels;\n\n    try {\n      await this._contract.draw(\n        {\n          pixels,\n        },\n        new BN(\"75000000000000\")\n      );\n      this._numFailedTxs = 0;\n    } catch (error) {\n      const msg = error.toString();\n      if (msg.indexOf(\"does not have enough balance\") !== -1) {\n        await this.refreshAllowance();\n        return;\n      }\n      console.log(\"Failed to send a transaction\", error);\n      this._numFailedTxs += 1;\n      if (this._numFailedTxs < 3) {\n        this._queue = this._queue.concat(this._pendingPixels);\n        this._pendingPixels = [];\n      } else {\n        this._pendingPixels = [];\n        this._queue = [];\n      }\n    }\n    try {\n      await Promise.all([this.refreshBoard(true), this.refreshAccountStats()]);\n    } catch (e) {\n      // ignore\n    }\n    this._pendingPixels.forEach((p) => {\n      if (this._pending[p.y][p.x] === p.color) {\n        this._pending[p.y][p.x] = -1;\n      }\n    });\n    this._pendingPixels = [];\n  }\n\n  async _pingQueue(ready) {\n    if (this._sendQueueTimer) {\n      clearTimeout(this._sendQueueTimer);\n      this._sendQueueTimer = null;\n    }\n\n    if (\n      this._pendingPixels.length === 0 &&\n      (this._queue.length >= BatchOfPixels || ready)\n    ) {\n      await this._sendQueue();\n    }\n    if (this._queue.length > 0) {\n      this._sendQueueTimer = setTimeout(async () => {\n        await this._pingQueue(true);\n      }, BatchTimeout);\n    }\n  }\n\n  async drawImg(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const balance = this.state.account ? this.state.account.avocadoBalance : 0;\n\n    if (\n      !this._isFreeDrawing() &&\n      balance - this.state.pendingPixels < this.state.avocadoNeeded\n    ) {\n      return;\n    }\n\n    const img = this.imageData;\n    const w = img.width;\n    const h = img.height;\n    const x = cell.x - Math.trunc(w / 2);\n    const y = cell.y - Math.trunc(h / 2);\n    const d = new Uint32Array(this.imageData.data.buffer);\n    for (let i = 0; i < h; ++i) {\n      for (let j = 0; j < w; ++j) {\n        const imgColor = d[i * w + j];\n        if (\n          imgColor &&\n          y + i >= 0 &&\n          y + i < BoardHeight &&\n          x + j >= 0 &&\n          x + j < BoardWidth\n        ) {\n          const bgColor = this._lines[y + i]\n            ? this._lines[y + i][x + j].color\n            : 0;\n          const color = imgColorToInt(imgColor, bgColor);\n          if (color !== bgColor) {\n            this._queue.push({\n              x: x + j,\n              y: y + i,\n              color,\n            });\n          }\n        }\n      }\n    }\n    this.setState({\n      rendering: false,\n    });\n\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    await this._pingQueue(false);\n  }\n\n  async drawPixel(cell) {\n    if (!this.state.signedIn || !this._lines || !this._lines[cell.y]) {\n      return;\n    }\n    const balance = this.state.account ? this.state.account.avocadoBalance : 0;\n    if (!this._isFreeDrawing() && balance - this.state.pendingPixels < 1) {\n      return;\n    }\n\n    const bgColor = this._lines[cell.y] ? this._lines[cell.y][cell.x].color : 0;\n    const cb = this.state.currentColor & 255;\n    const cg = (this.state.currentColor >> 8) & 255;\n    const cr = (this.state.currentColor >> 16) & 255;\n    const color = rgbaToInt(cr, cg, cb, this.state.alpha, bgColor);\n\n    if (\n      this._pending[cell.y][cell.x] !== color &&\n      this._lines[cell.y][cell.x].color !== color\n    ) {\n      this._pending[cell.y][cell.x] = color;\n    } else {\n      return;\n    }\n\n    this._queue.push({\n      x: cell.x,\n      y: cell.y,\n      color,\n    });\n\n    this._stopRefreshTime = new Date().getTime() + MaxWorkTime;\n    await this._pingQueue(false);\n  }\n\n  parseAccount(account, accountId) {\n    if (!account) {\n      account = {\n        accountId,\n        accountIndex: -1,\n        avocadoBalance: 25.0,\n        bananaBalance: 0.0,\n        numPixels: 0,\n        farmingPreference: Berry.Avocado,\n      };\n    } else {\n      account = {\n        accountId: account.account_id,\n        accountIndex: account.account_index,\n        avocadoBalance: parseFloat(account.avocado_balance) / this._pixelCost,\n        bananaBalance: parseFloat(account.banana_balance) / this._pixelCost,\n        numPixels: account.num_pixels,\n        farmingPreference: account.farming_preference,\n      };\n    }\n    account.startTime = new Date().getTime();\n    account.avocadoPixels =\n      account.farmingPreference === Berry.Avocado ? account.numPixels + 1 : 0;\n    account.bananaPixels =\n      account.farmingPreference === Berry.Banana ? account.numPixels : 0;\n    account.avocadoRewardPerMs = account.avocadoPixels / (24 * 60 * 60 * 1000);\n    account.bananaRewardPerMs = account.bananaPixels / (24 * 60 * 60 * 1000);\n    return account;\n  }\n\n  async getAccount(accountId) {\n    return this.parseAccount(\n      await this._contract.get_account({ account_id: accountId }),\n      accountId\n    );\n  }\n\n  async getAccountByIndex(accountIndex) {\n    return this.parseAccount(\n      await this._contract.get_account_by_index({\n        account_index: accountIndex,\n      }),\n      \"unknown\"\n    );\n  }\n\n  async refreshAccountStats() {\n    let account = await this.getAccount(this._accountId);\n    if (this._balanceRefreshTimer) {\n      clearInterval(this._balanceRefreshTimer);\n      this._balanceRefreshTimer = null;\n    }\n\n    this.setState({\n      pendingPixels: this._pendingPixels.length + this._queue.length,\n      farmingBanana: account.farmingPreference === Berry.Banana,\n      account,\n    });\n\n    this._balanceRefreshTimer = setInterval(() => {\n      const t = new Date().getTime() - account.startTime;\n      this.setState({\n        account: Object.assign({}, account, {\n          avocadoBalance:\n            account.avocadoBalance + t * account.avocadoRewardPerMs,\n          bananaBalance: account.bananaBalance + t * account.bananaRewardPerMs,\n        }),\n        pendingPixels: this._pendingPixels.length + this._queue.length,\n      });\n    }, 100);\n  }\n\n  async _initNear() {\n    const keyStore = new nearAPI.keyStores.BrowserLocalStorageKeyStore();\n    const near = await nearAPI.connect(\n      Object.assign({ deps: { keyStore } }, NearConfig)\n    );\n    this._keyStore = keyStore;\n    this._near = near;\n\n    this._walletConnection = new nearAPI.WalletConnection(\n      near,\n      NearConfig.contractName\n    );\n    this._accountId = this._walletConnection.getAccountId();\n\n    this._account = this._walletConnection.account();\n    this._contract = new nearAPI.Contract(\n      this._account,\n      NearConfig.contractName,\n      {\n        viewMethods: [\n          \"get_account\",\n          \"get_account_by_index\",\n          \"get_lines\",\n          \"get_line_versions\",\n          \"get_pixel_cost\",\n          \"get_account_balance\",\n          \"get_account_num_pixels\",\n          \"get_account_id_by_index\",\n          \"get_free_drawing_timestamp\",\n        ],\n        changeMethods: [\"draw\", \"buy_tokens\", \"select_farming_preference\"],\n      }\n    );\n    this._pixelCost = parseFloat(await this._contract.get_pixel_cost());\n    const freeDrawingTimestamp = await this._contract.get_free_drawing_timestamp();\n    this._freeDrawingStart = new Date(freeDrawingTimestamp);\n    this._freeDrawingEnd = new Date(freeDrawingTimestamp + OneDayMs);\n    if (this._accountId) {\n      await this.refreshAccountStats();\n    }\n    this._lineVersions = Array(BoardHeight).fill(-1);\n    this._lines = Array(BoardHeight).fill(false);\n    this._pending = Array(BoardHeight).fill(false);\n    this._pending.forEach((v, i, a) => (a[i] = Array(BoardWidth).fill(-1)));\n    await this.refreshBoard(true);\n  }\n\n  async refreshBoard(forced) {\n    if (this._refreshBoardTimer) {\n      clearTimeout(this._refreshBoardTimer);\n      this._refreshBoardTimer = null;\n    }\n    const t = new Date().getTime();\n    if (this.state.watchMode || t < this._stopRefreshTime) {\n      this._refreshBoardTimer = setTimeout(async () => {\n        await this.refreshBoard(false);\n      }, RefreshBoardTimeout);\n    }\n\n    if (!forced && document.hidden) {\n      return;\n    }\n\n    let lineVersions = await this._contract.get_line_versions();\n    let needLines = [];\n    for (let i = 0; i < BoardHeight; ++i) {\n      if (lineVersions[i] !== this._lineVersions[i]) {\n        needLines.push(i);\n      }\n    }\n    let requestLines = [];\n    for (let i = 0; i < needLines.length; i += NumLinesPerFetch) {\n      requestLines.push(needLines.slice(i, i + NumLinesPerFetch));\n    }\n\n    let results = await Promise.all(\n      requestLines.map((lines) => this._contract.get_lines({ lines }))\n    );\n    results = results.flat();\n    requestLines = requestLines.flat();\n    for (let i = 0; i < requestLines.length; ++i) {\n      let lineIndex = requestLines[i];\n      let line = decodeLine(results[i]);\n      this._lines[lineIndex] = line;\n    }\n\n    this._lineVersions = lineVersions;\n    if (!this.state.watchMode) {\n      this._refreshOwners();\n    }\n    this.renderCanvas();\n  }\n\n  _refreshOwners() {\n    const counts = {};\n    this._lines.flat().forEach((cell) => {\n      counts[cell.ownerIndex] = (counts[cell.ownerIndex] || 0) + 1;\n    });\n    delete counts[0];\n    const sortedKeys = Object.keys(counts).sort(\n      (a, b) => counts[b] - counts[a]\n    );\n    this.setState({\n      owners: sortedKeys.map((accountIndex) => {\n        accountIndex = parseInt(accountIndex);\n        return {\n          accountIndex,\n          numPixels: counts[accountIndex],\n        };\n      }),\n    });\n    sortedKeys.forEach(async (accountIndex) => {\n      accountIndex = parseInt(accountIndex);\n      if (\n        !(accountIndex in this._accounts) ||\n        counts[accountIndex] !== (this._oldCounts[accountIndex] || 0)\n      ) {\n        try {\n          this._accounts[accountIndex] = await this.getAccountByIndex(\n            accountIndex\n          );\n        } catch (err) {\n          console.log(\"Failed to fetch account index #\", accountIndex, err);\n        }\n        this.setState({\n          accounts: Object.assign({}, this._accounts),\n        });\n      }\n    });\n    this.setState({\n      accounts: Object.assign({}, this._accounts),\n    });\n    this._oldCounts = counts;\n  }\n\n  renderCanvas() {\n    if (!this._context || !this._lines) {\n      return;\n    }\n\n    const ctx = this._context;\n\n    for (let i = 0; i < BoardHeight; ++i) {\n      const line = this._lines[i];\n      if (!line) {\n        continue;\n      }\n      for (let j = 0; j < BoardWidth; ++j) {\n        const p = line[j];\n        ctx.fillStyle = intToColor(p.color);\n        ctx.fillRect(j * CellWidth, i * CellHeight, CellWidth, CellHeight);\n        if (this.state.highlightedAccountIndex >= 0) {\n          if (p.ownerIndex !== this.state.highlightedAccountIndex) {\n            ctx.fillStyle = \"rgba(32, 32, 32, 0.8)\";\n            ctx.fillRect(\n              j * CellWidth,\n              i * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillRect(\n              (j + 0.5) * CellWidth,\n              (i + 0.5) * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillStyle = \"rgba(0, 0, 0, 0.8)\";\n            ctx.fillRect(\n              j * CellWidth,\n              (i + 0.5) * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n            ctx.fillRect(\n              (j + 0.5) * CellWidth,\n              i * CellHeight,\n              CellWidth / 2,\n              CellHeight / 2\n            );\n          } else {\n            ctx.beginPath();\n            ctx.strokeStyle = ctx.fillStyle = \"rgba(255, 255, 255, 0.8)\";\n            ctx.lineWidth = 0.5;\n            ctx.rect(\n              j * CellWidth + 0.5,\n              i * CellHeight + 0.5,\n              CellWidth - 1,\n              CellHeight - 1\n            );\n            ctx.stroke();\n            ctx.closePath();\n          }\n        }\n      }\n    }\n\n    this._pendingPixels.concat(this._queue).forEach((p) => {\n      ctx.fillStyle = intToColor(p.color);\n      ctx.fillRect(p.x * CellWidth, p.y * CellHeight, CellWidth, CellHeight);\n    });\n\n    if (this.state.selectedCell && !this.state.watchMode) {\n      const c = this.state.selectedCell;\n      if (this.state.rendering) {\n        const img = this.imageData;\n        const w = img.width;\n        const h = img.height;\n        const x = c.x - Math.trunc(w / 2);\n        const y = c.y - Math.trunc(h / 2);\n        const d = new Uint32Array(this.imageData.data.buffer);\n        for (let i = 0; i < h; ++i) {\n          for (let j = 0; j < w; ++j) {\n            const color = d[i * w + j];\n            if (\n              color &&\n              y + i >= 0 &&\n              y + i < BoardHeight &&\n              x + j >= 0 &&\n              x + j < BoardWidth\n            ) {\n              const bgColor = this._lines[y + i]\n                ? this._lines[y + i][x + j].color\n                : 0;\n              ctx.fillStyle = intToColor(imgColorToInt(color, bgColor));\n              ctx.fillRect(\n                (x + j) * CellWidth,\n                (y + i) * CellHeight,\n                CellWidth,\n                CellHeight\n              );\n            }\n          }\n        }\n      } else if (this.state.pickingColor) {\n        const color = this._lines[c.y] ? this._lines[c.y][c.x].color : 0;\n        ctx.beginPath();\n        ctx.strokeStyle = ctx.fillStyle = transparentColor(color, 0.5);\n        ctx.lineWidth = CellWidth * 4;\n        ctx.arc(\n          (c.x + 0.5) * CellWidth,\n          (c.y + 0.5) * CellHeight,\n          CellWidth * 4,\n          0,\n          2 * Math.PI\n        );\n        ctx.stroke();\n        ctx.closePath();\n\n        ctx.beginPath();\n        ctx.strokeStyle = ctx.fillStyle = transparentColor(color, 1);\n        ctx.lineWidth = CellWidth * 2;\n        ctx.arc(\n          (c.x + 0.5) * CellWidth,\n          (c.y + 0.5) * CellHeight,\n          CellWidth * 4,\n          0,\n          2 * Math.PI\n        );\n        ctx.stroke();\n        ctx.closePath();\n      } else {\n        ctx.fillStyle = transparentColor(this.state.currentColor, 0.2);\n        ctx.fillRect(c.x * CellWidth, 0, CellWidth, c.y * CellHeight);\n        ctx.fillRect(\n          c.x * CellWidth,\n          (c.y + 1) * CellHeight,\n          CellWidth,\n          (BoardHeight - c.y - 1) * CellHeight\n        );\n        ctx.fillRect(0, c.y * CellHeight, c.x * CellWidth, CellHeight);\n        ctx.fillRect(\n          (c.x + 1) * CellWidth,\n          c.y * CellHeight,\n          (BoardWidth - c.x - 1) * CellWidth,\n          CellHeight\n        );\n\n        ctx.beginPath();\n        ctx.lineWidth = 3;\n        ctx.fillStyle = intToColor(this.state.currentColor);\n        ctx.strokeStyle = intToColor(this.state.currentColor);\n        ctx.rect(c.x * CellWidth, c.y * CellHeight, CellWidth, CellHeight);\n        ctx.stroke();\n        ctx.closePath();\n      }\n    }\n\n    if (!this.state.boardLoaded) {\n      this.setState({\n        boardLoaded: true,\n      });\n    }\n  }\n\n  async requestSignIn() {\n    const appTitle = \"Berry Club\";\n    await this._walletConnection.requestSignIn(\n      NearConfig.contractName,\n      appTitle\n    );\n  }\n\n  async logOut() {\n    this._walletConnection.signOut();\n    this._accountId = null;\n    this.setState({\n      signedIn: !!this._accountId,\n      accountId: this._accountId,\n    });\n  }\n\n  async alphaColorChange(c) {\n    this.setState(\n      {\n        alpha: c.rgb.a,\n      },\n      () => {\n        this.changeColor(c, c.rgb.a);\n      }\n    );\n  }\n\n  hueColorChange(c) {\n    this.setState({\n      gammaColors: generateGamma(c.hsl.h),\n    });\n    this.changeColor(c);\n  }\n\n  saveColor() {\n    const newColor = intToColor(this.state.currentColor);\n    const index = this.state.colors.indexOf(newColor);\n    if (index >= 0) {\n      this.state.colors.splice(index, 1);\n    }\n    this.setState({\n      colors: [newColor].concat(this.state.colors).slice(0, MaxNumColors),\n    });\n  }\n\n  changeColor(c, alpha) {\n    alpha = alpha || 1.0;\n    const currentColor = c.rgb.r * 0x010000 + c.rgb.g * 0x000100 + c.rgb.b;\n    c.hex = intToColorWithAlpha(currentColor, alpha);\n    c.rgb.a = alpha;\n    c.hsl.a = alpha;\n    c.hsv.a = alpha;\n    this.setState(\n      {\n        pickerColor: c,\n        alpha,\n        currentColor,\n      },\n      () => {\n        this.renderCanvas();\n      }\n    );\n  }\n\n  async buyTokens(amount) {\n    const requiredBalance = PixelPrice.muln(amount);\n    await this._contract.buy_tokens(\n      {},\n      new BN(\"30000000000000\"),\n      requiredBalance\n    );\n  }\n\n  setHover(accountIndex, v) {\n    if (v) {\n      this.setState(\n        {\n          highlightedAccountIndex: accountIndex,\n        },\n        () => {\n          this.renderCanvas();\n        }\n      );\n    } else if (this.state.highlightedAccountIndex === accountIndex) {\n      this.setState(\n        {\n          highlightedAccountIndex: -1,\n        },\n        () => {\n          this.renderCanvas();\n        }\n      );\n    }\n  }\n\n  async switchBerry(farmingBanana) {\n    this.setState({\n      farmingBanana,\n    });\n    await this._contract.select_farming_preference({\n      berry: farmingBanana ? Berry.Banana : Berry.Avocado,\n    });\n    await this.refreshAccountStats();\n  }\n\n  async renderImg(img, avocadoNeeded) {\n    this.imageData = img;\n    this.setState({\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n      rendering: true,\n      pickingColor: false,\n      avocadoNeeded,\n    });\n  }\n\n  _isFreeDrawing() {\n    const date = new Date();\n    return (\n      this.state.freeDrawingStart <= date && date < this.state.freeDrawingEnd\n    );\n  }\n\n  enableWatchMode() {\n    this.setState({\n      watchMode: true,\n      weaponsOn: false,\n      weaponsCodePosition: 0,\n    });\n    document.body.style.transition = \"3s\";\n    document.body.style.backgroundColor = \"#333\";\n  }\n\n  render() {\n    const watchClass = this.state.watchMode ? \" hidden\" : \"\";\n    const isFreeDrawing = this._isFreeDrawing();\n    const freeDrawing = (\n      <div\n        className={`free-drawing ${\n          isFreeDrawing ? \"free\" : \"wait\"\n        }${watchClass}`}\n      >\n        {isFreeDrawing\n          ? \"BANANZA!!! Draw for free \"\n          : \"Time until free drawing \"}\n        <Timer\n          initialTime={\n            isFreeDrawing\n              ? this.state.freeDrawingEnd - new Date()\n              : this.state.freeDrawingStart - new Date()\n          }\n          direction=\"backward\"\n          timeToUpdate={100}\n          lastUnit=\"d\"\n          checkpoints={[\n            {\n              time: 0,\n            },\n          ]}\n        >\n          {() => (\n            <React.Fragment>\n              <Timer.Days\n                formatValue={(v) => (v > 1 ? `${v} days ` : v ? `1 day ` : \"\")}\n              />\n              <Timer.Hours />:\n              <Timer.Minutes formatValue={(v) => `${v}`.padStart(2, \"0\")} />:\n              <Timer.Seconds formatValue={(v) => `${v}`.padStart(2, \"0\")} />.\n              <Timer.Milliseconds\n                formatValue={(v) => `${v}`.padStart(3, \"0\")}\n              />\n            </React.Fragment>\n          )}\n        </Timer>\n      </div>\n    );\n\n    const content = !this.state.connected ? (\n      <div>\n        Connecting...{\" \"}\n        <span\n          className=\"spinner-grow spinner-grow-sm\"\n          role=\"status\"\n          aria-hidden=\"true\"\n        />\n      </div>\n    ) : this.state.signedIn ? (\n      <div>\n        <div className={`float-right${watchClass}`}>\n          <button\n            className=\"btn btn-outline-secondary\"\n            onClick={() => this.logOut()}\n          >\n            Log out ({this.state.accountId})\n          </button>\n        </div>\n        {freeDrawing}\n        <div className={`your-balance${watchClass}`}>\n          Balance:{\" \"}\n          <Balance\n            account={this.state.account}\n            pendingPixels={this.state.pendingPixels}\n            isFreeDrawing={isFreeDrawing}\n            detailed={true}\n          />\n          <div>\n            Farming preference:\n            <Switch\n              onChange={(e) => this.switchBerry(e)}\n              checked={this.state.farmingBanana}\n              className=\"react-switch\"\n              height={30}\n              width={70}\n              offColor=\"#666\"\n              onColor=\"#666\"\n              uncheckedIcon={\n                <div className=\"switch-berry avocado\">{Avocado}</div>\n              }\n              checkedIcon={<div className=\"switch-berry banana\">{Banana}</div>}\n            />\n          </div>\n        </div>\n        <div className={`buttons${watchClass}`}>\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(10)}\n          >\n            Buy <span className=\"font-weight-bold\">25{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">Ⓝ0.1</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(40)}\n          >\n            Buy <span className=\"font-weight-bold\">100{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">Ⓝ0.4</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.buyTokens(100)}\n          >\n            Buy <span className=\"font-weight-bold\">250{Avocado}</span> for{\" \"}\n            <span className=\"font-weight-bold\">Ⓝ1</span>\n          </button>{\" \"}\n          <button\n            className=\"btn btn-success\"\n            onClick={() => this.buyTokens(500)}\n          >\n            DEAL: Buy <span className=\"font-weight-bold\">1500{Avocado}</span>{\" \"}\n            for <span className=\"font-weight-bold\">Ⓝ5</span>\n          </button>\n        </div>\n        <div className={`color-picker${watchClass}`}>\n          <HuePicker\n            color={this.state.pickerColor}\n            width=\"100%\"\n            onChange={(c) => this.hueColorChange(c)}\n          />\n          <AlphaPicker\n            color={this.state.pickerColor}\n            width=\"100%\"\n            onChange={(c) => this.alphaColorChange(c)}\n          />\n          <div\n            className={this.state.alpha >= 0.75 ? \"display-warning\" : \"hidden\"}\n          >\n            <span role=\"img\" aria-label=\"warning\">\n              ⚠️\n            </span>\n            ️ Please! Don't destroy art! If you just want to farm {Banana}, just\n            draw with low opacity.\n            <span role=\"img\" aria-label=\"pray\">\n              🙏\n            </span>\n            ️\n          </div>\n          <GithubPicker\n            className=\"circle-picker\"\n            colors={this.state.gammaColors}\n            color={this.state.pickerColor}\n            triangle=\"hide\"\n            width=\"100%\"\n            onChangeComplete={(c) => this.changeColor(c)}\n          />\n          <GithubPicker\n            className=\"circle-picker\"\n            colors={this.state.colors}\n            color={this.state.pickerColor}\n            triangle=\"hide\"\n            width=\"100%\"\n            onChangeComplete={(c) => this.hueColorChange(c)}\n          />\n        </div>\n      </div>\n    ) : (\n      <div style={{ marginBottom: \"10px\" }}>\n        {freeDrawing}\n        <div>\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => this.requestSignIn()}\n          >\n            Log in with NEAR Wallet\n          </button>\n        </div>\n      </div>\n    );\n    const weapons = this.state.weaponsOn ? (\n      <div>\n        <Weapons\n          account={this.state.account}\n          isFreeDrawing={isFreeDrawing}\n          renderIt={(img, avocadoNeeded) => this.renderImg(img, avocadoNeeded)}\n          enableWatchMode={() => this.enableWatchMode()}\n        />\n      </div>\n    ) : (\n      \"\"\n    );\n    return (\n      <div>\n        <div className={`header${watchClass}`}>\n          <h2>\n            {Avocado} Berry Club {Banana}\n          </h2>{\" \"}\n          <a className=\"btn btn-outline-none\" href=\"https://farm.berryclub.io\">\n            Berry Farm {Cucumber}\n          </a>\n          <a\n            className=\"btn btn-outline-none\"\n            href=\"https://app.ref.finance/#wrap.near|berryclub.ek.near\"\n          >\n            REF Finance {Banana}\n          </a>\n          <a className=\"btn btn-outline-none\" href=\"https://berry.cards\">\n            [BETA] Berry Cards {Pepper}\n          </a>\n          {content}\n        </div>\n        <div className=\"container\">\n          <div className=\"row\">\n            <div>\n              <div>\n                <canvas\n                  ref={this.canvasRef}\n                  width={600}\n                  height={600}\n                  className={\n                    this.state.boardLoaded\n                      ? `pixel-board${\n                          this.state.watchMode ? \" watch-mode\" : \"\"\n                        }`\n                      : \"pixel-board c-animated-background\"\n                  }\n                />\n              </div>\n            </div>\n            <div className={`leaderboard${watchClass}`}>\n              <div>\n                <Leaderboard\n                  owners={this.state.owners}\n                  accounts={this.state.accounts}\n                  setHover={(accountIndex, v) => this.setHover(accountIndex, v)}\n                  selectedOwnerIndex={this.state.selectedOwnerIndex}\n                  highlightedAccountIndex={this.state.highlightedAccountIndex}\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n        <div className={`padded${watchClass}`}>\n          {this.state.signedIn ? (\n            <div>\n              <iframe\n                title=\"irc\"\n                className=\"irc\"\n                frameBorder=\"0\"\n                src={`https://kiwiirc.com/client/irc.kiwiirc.com/?nick=${this.state.ircAccountId}#berryclub`}\n              />\n            </div>\n          ) : (\n            \"\"\n          )}\n        </div>\n        {/*<div className={`padded${watchClass}`}>*/}\n        {/*  <div className=\"video-container\">*/}\n        {/*    <iframe*/}\n        {/*      title=\"youtube3\"*/}\n        {/*      className=\"youtube\"*/}\n        {/*      src=\"https://www.youtube.com/embed/wfTa-Kgw2DM\"*/}\n        {/*      frameBorder=\"0\"*/}\n        {/*      allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"*/}\n        {/*      allowFullScreen*/}\n        {/*    />*/}\n        {/*  </div>*/}\n        {/*</div>*/}\n        {/*<div className={`padded${watchClass}`}>*/}\n        {/*  <div className=\"video-container\">*/}\n        {/*    <iframe*/}\n        {/*      title=\"youtube2\"*/}\n        {/*      className=\"youtube\"*/}\n        {/*      src=\"https://www.youtube.com/embed/PYF6RWd7ZgI\"*/}\n        {/*      frameBorder=\"0\"*/}\n        {/*      allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"*/}\n        {/*      allowFullScreen*/}\n        {/*    />*/}\n        {/*  </div>*/}\n        {/*</div>*/}\n        {/*<div className={`padded${watchClass}`}>*/}\n        {/*  <div className=\"video-container\">*/}\n        {/*    <iframe*/}\n        {/*      title=\"youtube\"*/}\n        {/*      className=\"youtube\"*/}\n        {/*      src=\"https://www.youtube.com/embed/lMSWhCwstLo\"*/}\n        {/*      frameBorder=\"0\"*/}\n        {/*      allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"*/}\n        {/*      allowFullScreen*/}\n        {/*    />*/}\n        {/*  </div>*/}\n        {/*</div>*/}\n        {weapons}\n        <a\n          className={`github-fork-ribbon right-bottom fixed${watchClass}`}\n          href=\"https://github.com/evgenykuzyakov/berryclub\"\n          data-ribbon=\"Fork me on GitHub\"\n          title=\"Fork me on GitHub\"\n        >\n          Fork me on GitHub\n        </a>\n      </div>\n    );\n  }\n}\n\nconst Balance = (props) => {\n  const account = props.account;\n  if (!account) {\n    return \"\";\n  }\n  const fraction = props.detailed ? 3 : 1;\n  const avacadoBalance =\n    account.avocadoBalance -\n    (props.isFreeDrawing ? 0 : props.pendingPixels || 0);\n  const avocadoFarm =\n    account.avocadoPixels > 0 ? (\n      <span>\n        {\"(+\"}\n        <span className=\"font-weight-bold\">{account.avocadoPixels}</span>\n        {Avocado}\n        {\"/day)\"}\n      </span>\n    ) : (\n      \"\"\n    );\n  const bananaFarm =\n    account.bananaPixels > 0 ? (\n      <span>\n        {\"(+\"}\n        <span className=\"font-weight-bold\">{account.bananaPixels}</span>\n        {Banana}\n        {\"/day)\"}\n      </span>\n    ) : (\n      \"\"\n    );\n  return (\n    <span className=\"balances font-small\">\n      <span className=\"font-weight-bold\">\n        {avacadoBalance.toFixed(fraction)}\n      </span>\n      {Avocado}{\" \"}\n      <span className=\"font-weight-bold\">\n        {account.bananaBalance.toFixed(fraction)}\n      </span>\n      {Banana} {avocadoFarm}\n      {bananaFarm}\n      {props.pendingPixels ? <span> ({props.pendingPixels} pending)</span> : \"\"}\n    </span>\n  );\n};\n\nconst Leaderboard = (props) => {\n  const owners = props.owners.map((owner) => {\n    if (owner.accountIndex in props.accounts) {\n      owner.account = props.accounts[owner.accountIndex];\n    }\n    return (\n      <Owner\n        key={owner.accountIndex}\n        {...owner}\n        isSelected={owner.accountIndex === props.selectedOwnerIndex}\n        setHover={(v) => props.setHover(owner.accountIndex, v)}\n        isHighlighted={owner.accountIndex === props.highlightedAccountIndex}\n      />\n    );\n  });\n  return (\n    <table className=\"table table-hover table-sm\">\n      <tbody>{owners}</tbody>\n    </table>\n  );\n};\n\nconst Owner = (props) => {\n  const account = props.account;\n  return (\n    <tr\n      onMouseEnter={() => props.setHover(true)}\n      onMouseLeave={() => props.setHover(false)}\n      className={props.isSelected ? \"selected\" : \"\"}\n    >\n      <td>{account ? <Account accountId={account.accountId} /> : \"...\"}</td>\n      <td className=\"text-nowrap\">\n        <small>\n          <Balance account={account} />\n        </small>\n      </td>\n    </tr>\n  );\n};\n\nconst Account = (props) => {\n  const accountId = props.accountId;\n  const shortAccountId =\n    accountId.length > 6 + 6 + 3\n      ? accountId.slice(0, 6) + \"...\" + accountId.slice(-6)\n      : accountId;\n  return (\n    <a className=\"account\" href={`https://wayback.berryclub.io/${accountId}`}>\n      {shortAccountId}\n    </a>\n  );\n};\n\nexport default App;\n","import \"./Weapons.scss\";\nimport React from \"react\";\nimport Files from \"react-files\";\n\nconst Avocado = (\n  <span role=\"img\" aria-label=\"avocado\" className=\"berry\">\n    🥑\n  </span>\n);\n\nexport class Weapons extends React.Component {\n  constructor(props) {\n    super(props);\n    this.canvasRef = React.createRef();\n    this.state = {\n      width: 48,\n      height: 28,\n      avocadoNeeded: 100,\n      lockedAspect: true,\n    };\n  }\n\n  componentDidMount() {\n    this.canvas = this.canvasRef.current;\n    this.ctx = this.canvas.getContext(\"2d\");\n    this.sourceImage = new Image();\n    this.sourceImage.onload = () => {\n      this.draw();\n    };\n    this.sourceImage.src = \"/bfg.png\";\n  }\n\n  draw() {\n    const sourceImage = this.sourceImage;\n    const canvas = this.canvas;\n    const ctx = this.ctx;\n    const width = this.state.width;\n    const height = this.state.height;\n\n    // Create a canvas with the desired dimensions\n    canvas.width = width;\n    canvas.height = height;\n    canvas.style.width = width * 10 + \"px\";\n    canvas.style.height = height * 10 + \"px\";\n\n    // Scale and draw the source image to the canvas\n    ctx.clearRect(0, 0, width, height);\n    ctx.imageSmoothingQuality = \"low\";\n    ctx.drawImage(sourceImage, 0, 0, width, height);\n\n    const imageData = ctx.getImageData(0, 0, width, height);\n    this.imageData = imageData;\n    this.setState({\n      avocadoNeeded: new Uint32Array(imageData.data.buffer).reduce(\n        (sum, v) => sum + (v ? 1 : 0),\n        0\n      ),\n    });\n  }\n\n  async onFilesChange(f) {\n    const sourceImage = this.sourceImage;\n    let reader = new FileReader();\n\n    reader.readAsDataURL(f[0]);\n\n    sourceImage.onload = () => {\n      let width = sourceImage.naturalWidth;\n      let height = sourceImage.naturalHeight;\n      if (sourceImage.naturalWidth > 50 || sourceImage.naturalHeight > 50) {\n        const aspect = width / height;\n        width = Math.round(20 * Math.min(1, aspect));\n        height = Math.round(20 * Math.min(1, 1 / aspect));\n      }\n      this.setState({\n        width: Math.min(50, Math.max(1, width)),\n        height: Math.min(50, Math.max(1, height)),\n      });\n      this.draw();\n    };\n\n    reader.onload = function (event) {\n      sourceImage.src = event.target.result;\n    };\n  }\n\n  async onFilesError(e, f) {\n    console.log(e, f);\n  }\n\n  updateVal(key, value) {\n    value = Math.min(50, Math.max(1, value));\n    if (this.state.lockedAspect) {\n      const aspect =\n        this.sourceImage.naturalWidth / this.sourceImage.naturalHeight;\n      let width, height;\n      if (key === \"width\") {\n        width = value;\n        height = Math.round(width / aspect);\n      } else {\n        height = value;\n        width = Math.round(height * aspect);\n      }\n      this.setState(\n        {\n          width: Math.min(50, Math.max(1, width)),\n          height: Math.min(50, Math.max(1, height)),\n        },\n        () => {\n          this.draw();\n        }\n      );\n    } else {\n      this.setState(\n        {\n          [key]: value,\n        },\n        () => {\n          this.draw();\n        }\n      );\n    }\n  }\n\n  changeLockedAspect() {\n    this.setState({\n      lockedAspect: !this.state.lockedAspect,\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"weapons-popup\">\n        <div className=\"weapons-content\">\n          <h2>So you need a BFG?</h2>\n          <div>\n            <Files\n              type=\"button\"\n              className=\"btn\"\n              onChange={(f) => this.onFilesChange(f)}\n              onError={(e, f) => this.onFilesError(e, f)}\n              multiple={false}\n              accepts={[\"image/*\"]}\n              minFileSize={1}\n              clickable\n            >\n              Click to upload an image\n            </Files>\n          </div>\n          <div>\n            <label>Width</label>\n            <input\n              type=\"number\"\n              value={this.state.width}\n              min={1}\n              max={50}\n              onChange={(e) => this.updateVal(\"width\", e.target.value)}\n            />{\" \"}\n            <button\n              className={\n                \"btn btn-outline-secondary low-right-margin\" +\n                (this.state.lockedAspect ? \" btn-pressed\" : \" btn-not-pressed\")\n              }\n              onClick={() => this.changeLockedAspect()}\n            >\n              <span role=\"img\" aria-label=\"link\" className=\"berry\">\n                🔗\n              </span>\n            </button>\n            <label>Height</label>\n            <input\n              type=\"number\"\n              value={this.state.height}\n              min={1}\n              max={50}\n              onChange={(e) => this.updateVal(\"height\", e.target.value)}\n            />\n          </div>\n          <button\n            className=\"btn btn-success btn-large\"\n            disabled={\n              !this.props.account ||\n              (!this.props.isFreeDrawing &&\n                this.props.account.avocadoBalance < this.state.avocadoNeeded)\n            }\n            onClick={() =>\n              this.props.renderIt(this.imageData, this.state.avocadoNeeded)\n            }\n          >\n            Render on the board using {this.state.avocadoNeeded} {Avocado}\n          </button>\n          <button\n            className=\"btn btn-primary btn-large\"\n            onClick={() => this.props.enableWatchMode()}\n          >\n            Enable watch mode\n          </button>\n          <div className=\"canvas-wrapper\">\n            <canvas\n              ref={this.canvasRef}\n              width={480}\n              height={280}\n              className=\"draw-preview\"\n            ></canvas>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}